# Shopping List API – Ruby on Rails

## Overview

This project is a Ruby on Rails application providing a REST API for managing shopping list items. The API supports creating, reading, updating, and deleting (CRUD) items. The application is optimized for use in GitHub Codespaces and uses Swagger (Rswag) for automatic API documentation.

---

## Features

- **CRUD API for Shopping List Items**  
  Endpoints for adding, viewing, editing, and deleting items.
- **Swagger Documentation**  
  Automatically generated and interactive API documentation at `/api-docs`.
- **Docker & Compose Support**  
  Simple local development and deployment with Docker.
- **Kubernetes Support**  
  Run the application in a local Kubernetes cluster using kind.
- **RSpec & Rswag**  
  Integration of tests and API specifications.

---

## Project Structure

- .devcontainer/: Configuration for the Codespaces development container
- app/controllers/: Contains controllers, e.g., [`ItemsController`](app/controllers/items_controller.rb)
- app/models/: Contains models, e.g., [`Item`](app/models/item.rb)
- config/routes.rb: Defines the API routes
- swagger/swagger.yaml: OpenAPI specification (generated by Rswag)
- spec/integration/items_spec.rb: Rswag integration tests for the API
- docker-compose.yml & Dockerfile: Containerization
- k8s/: Kubernetes manifests
- kind-config.yaml: kind cluster configuration

---

## API Documentation

The API documentation is created according to the OpenAPI standard and can be viewed at  
`/swagger/swagger.yaml`.
Or when the server is running, you can access the interactive Swagger UI when opening the backend service in your browser.
To test the API using Swagger UI you need to add your backend service URL to the `servers` section in the `swagger/swagger.yaml` file.

---

## Quick Start

### Local (Uncontainerized)

1. **Install dependencies**
   ```bash
   bundle install
   ```

2. **Generate Swagger documentation**
   ```bash
   rake rswag:specs:swaggerize
   ```

3. **Start the server**
   ```bash
   rails server
   ```

### Docker (Docker Compose)

```bash
docker compose up --build
```

---

### Kubernetes (kind)

1. **Create a kind cluster**
   ```bash
   kind create cluster --config kind-config.yaml
   ```

2. **Deploy the application to Kubernetes**
   ```bash
   kubectl apply -f k8s/
   ```

3. **Check if pods and services are ready**
   ```bash
   kubectl get pods
   kubectl get svc
   ```

You may need to wait a few moments for the pods to be ready.

4. **Port-forward services to your localhost**
   ```bash
   kubectl port-forward svc/backend 3000:3000
   kubectl port-forward svc/frontend 5000:5000
   ```

---

## Key Endpoints

- `GET    /items` – Retrieve all items
- `POST   /items` – Create an item or increase its quantity
- `GET    /items/{id}` – Retrieve a single item
- `PUT    /items/{id}` – Update an item
- `DELETE /items/{id}` – Delete an item

Details and example requests can be found in the Swagger UI.

---

## Tests

- **RSpec**:  
  Tests are located in the [`spec/`](spec/) directory.
- **Swagger Integration Tests**:  
  See [`spec/integration/items_spec.rb`](spec/integration/items_spec.rb).

Run tests:
```bash
bundle exec rspec
```

---

## Development Notes

- The application uses SQLite as the default database.
- CORS is enabled for all origins in development.
- The API is prepared for integration with a separate frontend (see `docker-compose.yml`).